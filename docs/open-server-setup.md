# Настройка PostgreSQL в Open Server v5

## Шаг 1: Установка Open Server

1. Скачайте Open Server v5 с официального сайта: https://ospanel.io/
2. Установите Open Server на ваш компьютер
3. Запустите Open Server

## Шаг 2: Настройка PostgreSQL

1. Откройте панель управления Open Server (нажмите на иконку в трее)
2. Перейдите в "Дополнительно" -> "Конфигурация" -> "Модули"
3. Убедитесь, что модуль PostgreSQL включен
4. Запустите сервер, нажав на кнопку "Запустить" в главном меню Open Server

## Шаг 3: Проверка порта PostgreSQL

В Open Server PostgreSQL может работать на нестандартном порту. Давайте проверим:

1. Откройте панель управления Open Server
2. Перейдите в "Настройки" -> "Модули" -> "PostgreSQL"
3. Проверьте порт в конфигурации (по умолчанию 5432)
4. Если порт отличается от 5432, запомните его для дальнейшей настройки

## Шаг 4: Создание базы данных

1. Откройте pgAdmin (входит в состав Open Server)
   - В трее Open Server нажмите правой кнопкой мыши -> "Дополнительно" -> "PostgreSQL" -> "pgAdmin"
   - Или откройте браузер и перейдите по адресу: http://localhost/pgadmin

2. Войдите в pgAdmin:
   - Логин: postgres
   - Пароль: postgres (стандартный пароль в Open Server, может отличаться)

3. Создайте новую базу данных:
   - Правой кнопкой мыши на "Databases" -> "Create" -> "Database..."
   - Введите имя базы данных: fishdvizh
   - Нажмите "Save"

## Шаг 5: Настройка подключения в проекте

1. Создайте или отредактируйте файл `.env` в корне проекта.
   Используйте команду:
   ```
   npm run setup-env
   ```
   
   Или создайте файл вручную с содержимым:
   ```
   DATABASE_URL="postgresql://postgres:postgres@localhost:5432/fishdvizh"
   NEXTAUTH_SECRET="your-secret-key"
   NEXTAUTH_URL="http://localhost:3000"
   ```

2. Обратите внимание на параметры подключения:
   - Пользователь: postgres
   - Пароль: postgres (стандартный пароль в Open Server, уточните в настройках)
   - Хост: localhost
   - Порт: 5432 (или другой порт, если он был изменен в настройках)
   - База данных: fishdvizh

## Шаг 6: Применение миграций

1. Запустите миграцию базы данных:
```bash
npm run prisma:migrate
```

2. Сгенерируйте клиент Prisma:
```bash
npm run prisma:generate
```

## Возможные проблемы и их решение

### 1. Ошибка подключения к PostgreSQL

Если вы видите ошибку: `Can't reach database server at localhost:5432`

**Решение:**
- Убедитесь, что Open Server запущен (зеленый индикатор в трее)
- Проверьте, что модуль PostgreSQL активирован в настройках
- Проверьте порт PostgreSQL в настройках Open Server
- Убедитесь, что в файле .env указан правильный порт

### 2. Ошибка аутентификации

Если вы видите ошибку аутентификации:

**Решение:**
- Проверьте пароль пользователя postgres в Open Server:
  - Откройте панель управления Open Server
  - Перейдите в "Настройки" -> "Модули" -> "PostgreSQL"
  - Проверьте параметр "Пароль суперпользователя"
- Обновите пароль в строке подключения в файле .env

### 3. Проверка работы PostgreSQL

Чтобы убедиться, что PostgreSQL работает:
1. Откройте командную строку
2. Выполните команду:
   ```
   netstat -an | findstr 5432
   ```
   Вы должны увидеть, что порт 5432 (или другой настроенный порт) прослушивается

### 4. Альтернативный способ подключения

Если стандартное подключение не работает, попробуйте:
1. Открыть pgAdmin из Open Server
2. Подключиться к серверу вручную
3. Проверить настройки подключения (хост, порт, имя пользователя, пароль)
4. Обновить файл .env с правильными параметрами 